<%*
let cmEditorAct = this.app.workspace.activeLeaf.view.editor;

// Definujeme název souboru, do kterého se budou ukládat vyjmuté řádky
const filePath = "tasks-organize.md";

// Získáme celý obsah souboru
let fullContent = cmEditorAct.getValue();

// Získání pozice kurzoru a obsahu aktuálního řádku
let currentCursor = cmEditorAct.getCursor();
let currentLine = currentCursor.line;
let lineContents = cmEditorAct.getLine(currentLine);

// Zkontrolujeme, že obsah řádku není prázdný
if (lineContents.trim() !== '') {
    // Rozdělíme obsah souboru na jednotlivé řádky
    let lines = fullContent.split('\n');

    // Vyjmeme aktuální řádek a přidáme ho do proměnné pro pozdější použití
    let cutLine = lines.splice(currentLine, 1)[0].trim();  // Vyjmeme správný řádek a trimujeme mezery

    // Nově zformátovaný obsah souboru (bez vyjmutého řádku)
    let newContent = lines.join('\n');

    // Nastavení nového obsahu souboru zpět do editoru
    cmEditorAct.setValue(newContent);

    // Zkontrolujeme, jestli soubor už existuje
    let targetFile;
    try {
        targetFile = await this.app.vault.adapter.read(filePath);
    } catch (err) {
        targetFile = ''; // Pokud soubor neexistuje, vytvoříme nový obsah
    }

    // Přidáme vyjmutý řádek na konec cílového souboru
    targetFile += `\n${cutLine}`;

    // Uložíme nový obsah zpět do souboru
    await this.app.vault.adapter.write(filePath, targetFile);

} else {
    console.log("Řádek je prázdný, nebude zkopírován.");
}
%>
